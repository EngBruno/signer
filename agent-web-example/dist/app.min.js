angular.module("agent",["cfp.loadingBar","ui-notification"]).config(["NotificationProvider",function(e){e.setOptions({delay:5e3,startTop:10,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"right",positionY:"bottom"})}]).controller("MainController",["$scope","$http","$timeout","cfpLoadingBar","Notification",function(e,n,t,o,i){e.webExtensionIsOn=!1,e.desktopClientIsOn=!1,e.webExtSupported=!0,e.startRequest=function(){o.start()},e.stopRequest=function(){o.complete()},e.webExtensionId="ignkfmddfcgkkpkopkafjjbbpagofgka",e.signFile=function(){e.startRequest(),e.sendMessageToWebExtension({command:"signerFileUsingDefaults"},function(n){console.log(n),i.success("Success, file p7s generate in "+n.signed),e.fileName=n.original,e.signedFileName=n.signed,e.stopRequest()},function(n){console.log(n),e.fileName="",e.signedFileName="",e.stopRequest()})},e.validateFile=function(){e.startRequest(),e.sendMessageToWebExtension({command:"validateFile"},function(n){console.log(n),t(function(){e.valid=n.valid,void 0!==e.subject&&(e.subject=n.by.subject),e.message=n.message},100),e.stopRequest()},function(n){console.log(n),e.stopRequest()})},e.sendMessageToWebExtension=function(n,t,o){try{return chrome.runtime.sendMessage(e.webExtensionId,n,function(n){void 0!==n?t(n):(e.webExtensionIsOn=!1,e.desktopClientIsOn=!1,e.webExtSupported=!0,e.verifyAll(),o("Verifique se a Extensão do Navegador esta instalada."))}),chrome}catch(n){return e.webExtSupported=!1,i.error("Este navegador não é suportado."),null}},e.verifyPreRequisites=function(){e.sendMessageToWebExtension({command:"desktopStatus"},function(n){t(function(){e.webExtensionIsOn=!0,e.desktopClientIsOn=n},10)},function(n){t(function(){e.webExtensionIsOn=!1,e.desktopClientIsOn=!1},10)})},e.verifyAll=function(){e.webExtensionIsOn&&e.desktopClientIsOn||e.verifyPreRequisites(),t(e.verifyAll,5e3)},t(e.verifyAll,10)}]);