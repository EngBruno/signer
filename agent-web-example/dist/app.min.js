angular.module("agent",["cfp.loadingBar","ui-notification"]).config(["NotificationProvider",function(e){e.setOptions({delay:5e3,startTop:10,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"right",positionY:"bottom"})}]).controller("MainController",["$scope","$http","$timeout","cfpLoadingBar","Notification",function(e,n,o,t,s){e.webExtensionIsOn=!1,e.desktopClientIsOn=!1,e.startRequest=function(){t.start()},e.stopRequest=function(){t.complete()},e.webExtensionId="ignkfmddfcgkkpkopkafjjbbpagofgka",e.browser=function(){return void 0!==chrome?chrome:browser},e.signFile=function(){e.startRequest(),e.sendMessageToWebExtension({command:"signerFileUsingDefaults"},function(n){console.log(n),s.success("Success, file p7s generate in "+n.signed),e.fileName=n.original,e.signedFileName=n.signed,e.stopRequest()},function(n){console.log(n),e.fileName="",e.signedFileName="",e.stopRequest()})},e.validateFile=function(){e.startRequest(),e.sendMessageToWebExtension({command:"validateFile"},function(n){console.log(n),o(function(){e.valid=n.valid,void 0!==e.subject&&(e.subject=n.by.subject),e.message=n.message},100),e.stopRequest()},function(n){console.log(n),e.stopRequest()})},e.sendMessageToWebExtension=function(n,o,t){e.browser().runtime.sendMessage(e.webExtensionId,n,function(e){void 0!==e?o(e):t("Verifique se a Extens√£o do Navegador esta instalada.")})},e.getLastError=function(){console.log(e.browser().lastError)},e.verifyDesktopClientIsOn=function(){e.sendMessageToWebExtension({command:"desktopStatus"},function(n){e.desktopClientIsOn=!0},function(n){e.desktopClientIsOn=!1})},e.verifyWebExtensionIsOn=function(){e.sendMessageToWebExtension({command:"status"},function(n){o(function(){e.webExtensionIsOn="OK"===n.status},100)},function(n){o(function(){e.webExtensionIsOn=!1},100)})},e.verifyAll=function(){console.log("webExtensionId: "+e.webExtensionId),e.verifyDesktopClientIsOn(),e.verifyWebExtensionIsOn(),o(e.verifyAll,2e3)},e.verifyAll()}]);