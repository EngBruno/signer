var Promise=function(){var e=null,r=null;this.success=function(r){return e=r,this},this.error=function(e){return r=e,this},this.resolve=function(r){e(r)},this.hasCallbackError=function(){return null!==r},this.reject=function(e){r(e)}},SignerDesktopClient=function(){var e,r=[],t="ws://localhost:9091/",n=!1,i=function(e){n&&console.log(e)},a={setUriServer:function(e){i("Setting URI to "+e),t=e},setDebug:function(e){i("Setting debug on to "+(e?"ON":"OFF")),n=e},connect:function(n,a,o){null!=e&&1==e.readyState||(i("Connecting on "+t),e=new WebSocket(t),e.onopen=function(e){n&&n(e.target.readyState)},e.onclose=function(e){a&&a(e.target.readyState)},e.onmessage=function(e){var t=JSON.parse(e.data);void 0!==t&&void 0!==t.error?void 0!==t.requestId&&r[t.requestId].hasCallbackError()?r[t.requestId].reject(t):o&&o(t):(i("Receiving command with ID ["+t.requestId+"]"),void 0!=t.requestId&&void 0!==r[t.requestId]?r[t.requestId].resolve(t):(i("No callback to success was defined."),i(t)))},e.onerror=function(e){void 0!==r[e.requestId]?r[e.requestId].reject(e):(i("No callback to success was defined. Generic error."),o(e))})},isConnected:function(){return null!=e&&1==e.readyState},signer:function(e,r,t,n){var i={command:"signer",type:"raw",format:"text",compacted:!1,alias:e,signaturePolicy:n,provider:r,content:t},o=a.execute(i);return o},validate:function(e,r){var t={command:"validate",format:"base64",content:e,signature:r},n=a.execute(t);return n},signerFile:function(e,r,t,n){var i={command:"filesigner",type:"raw",format:"text",compacted:!1,alias:e,signaturePolicy:n,provider:r,content:t},o=a.execute(i);return o},validateFile:function(){var e={command:"validatefile"},r=a.execute(e);return r},signerFileUsingDefaults:function(){var e={command:"filesignerusingdefaults",type:"raw",format:"text",compacted:!1},r=a.execute(e);return r},logoutPKCS11:function(){var r={command:"logoutpkcs11"};e.send(JSON.stringify(r))},status:function(){var e={command:"status"},r=a.execute(e);return r},listCerts:function(){var e={command:"listcerts"},r=a.execute(e);return r},listPolicies:function(){var e={command:"listpolicies"},r=a.execute(e);return r},getFiles:function(){var e={command:"getfiles"},r=a.execute(e);return r},shutdown:function(){var r={command:"shutdown"};e.send(JSON.stringify(r))},execute:function(n){return void 0!==n.requestId&&""!==n.requestId||(n.requestId=(new Date).getTime()),i("Sending command ["+n.command+"] with ID ["+n.requestId+"] to URI ["+t+"]"),i(n),r[n.requestId]=new Promise,e.send(JSON.stringify(n)),r[n.requestId]},setUriServerWrapper:function(e){i("Wrapper called"),a.setUriServer(e.uri)},setDebugWrapper:function(e){i("Wrapper called"),a.setDebug(e.isToDebug)},connectWrapper:function(e){i("Wrapper called"),a.connect(e.callbackOpen,e.callbackClose,e.callbackError)},isConnectedWrapper:function(e){return i("Wrapper called"),a.isConnected()},signerWrapper:function(e){return i("Wrapper called"),a.signer(e.alias,e.provider,e.content,e.signaturePolicy)},validateWrapper:function(e){return i("Wrapper called"),a.validate(e.content,e.signature)},signerFileWrapper:function(e){return i("Wrapper called"),a.signerFile(e.alias,e.provider,e.fileName,e.signaturePolicy)},validateFileWrapper:function(e){return i("Wrapper called"),a.validateFile()},signerFileUsingDefaultsWrapper:function(e){return i("Wrapper called"),a.signerFileUsingDefaults()},logoutPKCS11Wrapper:function(e){i("Wrapper called"),a.logoutPKCS11()},statusWrapper:function(e){return i("Wrapper called"),a.status()},listCertsWrapper:function(e){return i("Wrapper called"),a.listCerts()},listPoliciesWrapper:function(){return i("Wrapper called"),a.listPolicies()},getFilesWrapper:function(){return i("Wrapper called"),a.getFiles()},shutdownWrapper:function(){i("Wrapper called"),a.shutdown()}};return a}();