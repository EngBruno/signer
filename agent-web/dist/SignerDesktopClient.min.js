var Promise=function(){var n=null,e=null;this.success=function(e){return console.log("Then with success"),n=e,this},this.error=function(n){return console.log("Then with error"),e=n,this},this.resolve=function(e){n(e)},this.hasCallbackError=function(){return null!==e},this.reject=function(n){e(n)}},SignerDesktopClient=function(){var n,e=null,t="ws://localhost:9091/",r=!1,o=function(n){r&&console.log(n)},i={setUriServer:function(n){o("Setting URI to "+n),t=n},setDebug:function(n){o("Setting debug on to "+(n?"ON":"OFF")),r=n},connect:function(r,i,c){null!=n&&1==n.readyState||(o("Connecting on "+t),n=new WebSocket(t),n.onopen=function(n){o("On Open"),r&&r(n.target.readyState)},n.onclose=function(n){o("On Close"),i&&i(n.target.readyState)},n.onmessage=function(n){o("On Message");var t=JSON.parse(n.data);void 0!==t&&void 0!==t.error?e.hasCallbackError()?(o("On Error Function Callback"),e.reject(t)):c&&(o("On Error Generic Callback"),c(t)):(o("On Error Normal Callback"),e.resolve(t))},n.onerror=function(n){e.hasCallbackError()?(o("On Error Function Callback"),e.reject(n)):c&&(o("On Error Generic Callback"),c(n))})},isConnected:function(){return null!=n&&1==n.readyState},signer:function(n,e,t,r){var o={command:"signer",type:"raw",format:"text",compacted:!1,alias:n,signaturePolicy:r,provider:e,content:t},c=i.execute(o);return c},signerWithPassword:function(n,e,t,r,o){var c={command:"signer",type:"raw",format:"text",compacted:!1,alias:n,signaturePolicy:o,password:e,provider:t,content:r},a=i.execute(c);return a},logoutPKCS11:function(){var e={command:"logoutpkcs11"};n.send(JSON.stringify(e))},status:function(){var n={command:"status"},e=i.execute(n);return e},listCerts:function(n){var e={command:"listcerts",password:n},t=i.execute(e);return t},listPolicies:function(){var n={command:"listpolicies"},e=i.execute(n);return e},getFiles:function(){var n={command:"getfiles"},e=i.execute(n);return e},signerFile:function(n,e,t,r){var o={command:"filesigner",type:"raw",format:"text",compacted:!1,alias:n,signaturePolicy:r,provider:e,content:t},c=i.execute(o);return c},shutdown:function(){var e={command:"shutdown"};n.send(JSON.stringify(e))},execute:function(r){return o("Sending command ["+r.command+"] to URI ["+t+"]"),e=new Promise,n.send(JSON.stringify(r)),e}};return i}();void 0===window.SignerDesktopClient?(console.log("SignerDesktopClient started."),window.SignerDesktopClient=new SignerDesktopClient):console.log("SignerDesktopClient already defined.");